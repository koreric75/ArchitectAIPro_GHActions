%% Generated by Architect AI Pro | BlueFalconInk LLC
%% https://architect-ai-pro-mobile-edition-484078543321.us-west1.run.app/
graph TD
    subgraph "BlueFalconInk LLC - ArchitectAIPro_GHActions Architecture"
        subgraph "External Integrations"
            User[Public User]
            GitHub[GitHub.com]
            Gemini[Google Gemini API]
            MermaidInk[mermaid.ink Â· Fallback Renderer]
            DrawioCLI[drawio-desktop CLI Â· Local Renderer]
        end

        subgraph "GitHub Automation"
            GHActions[GitHub Actions Runner]
            ArchitectAIWorkflow[Architect AI Pro Workflow]
            InfraDeployWorkflow[Terraform Deploy Workflow]
        end

        subgraph "Application Layer"
            CloudLB[Cloud Load Balancer]
            CloudRun[Cloud Run Service Â· Architecture Gallery]
            GalleryApp[FastAPI Gallery App]
        end

        subgraph "Data Layer"
            SecretManager[Cloud Secret Manager]
            GCSBackend[Cloud Storage Â· Terraform State]
            ArtifactRegistry[Artifact Registry]
            GCSBackend[GCS Terraform Backend]
        end

        subgraph "Security"
            CloudArmor[Cloud Armor]
            WIFPool[Workload Identity Pool]
            WIFProvider[WIF OIDC Provider]
            ForemanSA[Service Account Â· architect-ai-foreman]
        end

        subgraph "Repository Assets"
            Docs[docs/architecture.md]
            MermaidFile[docs/architecture.mermaid]
            DrawioFile[docs/architecture.drawio]
            PNGFile[docs/architecture.png]
            Plugins[Mermaid Conversion Plugins]
        end
    end

    User -->|HTTPS Requests| CloudLB
    CloudLB -->|Protects| CloudRun
    CloudLB -->|Routes HTTPS| CloudRun
    CloudRun -->|HTTP| GalleryApp
    GalleryApp -->|Reads GITHUB_TOKEN| SecretManager
    GalleryApp -->|Fetches Repo/File Content| GitHub

    GitHub -->|Code Push / PR Trigger| GHActions
    GHActions -->|Executes arch-sync.yml| ArchitectAIWorkflow
    GHActions -->|Executes deploy-infra.yml| InfraDeployWorkflow

    ArchitectAIWorkflow -->|Calls for Diagram Generation| Gemini
    ArchitectAIWorkflow -->|Renders PNG from XML| DrawioCLI
    ArchitectAIWorkflow -->|Renders PNG Fallback| MermaidInk
    ArchitectAIWorkflow -->|Writes Mermaid Source| MermaidFile
    ArchitectAIWorkflow -->|Writes Draw.io XML| DrawioFile
    ArchitectAIWorkflow -->|Writes PNG Image| PNGFile
    MermaidFile -->|Included in| Docs
    DrawioFile -->|Included in| Docs
    PNGFile -->|Included in| Docs
    ArchitectAIWorkflow -->|Reads for Audit/Remediation| Docs
    ArchitectAIWorkflow -->|Commits Changes| GitHub
    ArchitectAIWorkflow -->|Posts PR Comment| GitHub
    ArchitectAIWorkflow -->|Uploads Artifacts| GHActions

    InfraDeployWorkflow -->|OIDC Token Exchange| WIFPool
    WIFPool -->|Provides Identity| WIFProvider
    WIFProvider -->|Assumes Role| ForemanSA
    ForemanSA -->|Manages Cloud Run| CloudRun
    ForemanSA -->|Accesses Secrets| SecretManager
    ForemanSA -->|Pushes Container Images| ArtifactRegistry
    InfraDeployWorkflow -->|Provisions/Updates| CloudRun
    InfraDeployWorkflow -->|Provisions/Updates| SecretManager
    InfraDeployWorkflow -->|Provisions/Updates| WIFPool
    InfraDeployWorkflow -->|Provisions/Updates| WIFProvider
    InfraDeployWorkflow -->|Provisions/Updates| ForemanSA
    InfraDeployWorkflow -->|Stores State| GCSBackend

    style Application Layer fill:#1E3A5F,color:#BFDBFE
    style Data Layer fill:#0F172A,color:#BFDBFE
    style Security fill:#1E40AF,color:#BFDBFE
    FOOTER[ğŸ—ï¸ Created with Architect AI Pro Â· BlueFalconInk LLC]
    style FOOTER fill:#1E40AF,color:#BFDBFE,stroke:#3B82F6